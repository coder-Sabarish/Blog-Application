apiVersion: api.cerbos.dev/v1
resourcePolicy:
  version: "default"
  importDerivedRoles:
    - common_roles
  resource: "user"
  rules:
    - actions: ['create']
      effect: EFFECT_ALLOW
      derivedRoles:
        - admin

    - actions: ['delete']
      effect: EFFECT_ALLOW
      derivedRoles:
        - admin

    - actions: ['choose moderator']
      effect: EFFECT_ALLOW
      derivedRoles:
        - admin

    - actions: ['choose admin']
      effect: EFFECT_ALLOW
      derivedRoles:
        - admin

    - actions: ['getAll']
      effect: EFFECT_ALLOW
      derivedRoles:
        - admin

    - actions: ['getByUserName']
      effect: EFFECT_ALLOW
      derivedRoles:
        - admin